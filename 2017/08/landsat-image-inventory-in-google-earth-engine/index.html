<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.90.0 with theme Tranquilpeak 0.4.8-BETA">
<meta name="author" content="Philipp G채rtner">
<meta name="keywords" content=", earth-observation, remote sensing, earth engine, google earth enngine">
<meta name="description" content="Welcome, to my first step by step tutorial to investigate Landsat image availability and metadata properties for every country within the Earth Engine.">


<meta property="og:description" content="Welcome, to my first step by step tutorial to investigate Landsat image availability and metadata properties for every country within the Earth Engine.">
<meta property="og:type" content="article">
<meta property="og:title" content="Landsat image inventory in Google Earth Engine">
<meta name="twitter:title" content="Landsat image inventory in Google Earth Engine">
<meta property="og:url" content="https://philippgaertner.github.io/2017/08/landsat-image-inventory-in-google-earth-engine/">
<meta property="twitter:url" content="https://philippgaertner.github.io/2017/08/landsat-image-inventory-in-google-earth-engine/">
<meta property="og:site_name" content="Philipp G채rtner Blog">
<meta property="og:description" content="Welcome, to my first step by step tutorial to investigate Landsat image availability and metadata properties for every country within the Earth Engine.">
<meta name="twitter:description" content="Welcome, to my first step by step tutorial to investigate Landsat image availability and metadata properties for every country within the Earth Engine.">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2017-08-08T00:00:00">
  
  
    <meta property="article:modified_time" content="2017-08-08T00:00:00">
  
  
  
    
      <meta property="article:section" content="Landsat">
    
      <meta property="article:section" content="Tutorial">
    
      <meta property="article:section" content="GitHub Code">
    
  
  
    
      <meta property="article:tag" content="FeatureCollection">
    
      <meta property="article:tag" content="ImageCollection">
    
      <meta property="article:tag" content="Google-Earth-Engine">
    
      <meta property="article:tag" content="Metadata">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@Mixed_Pixels">


  <meta name="twitter:creator" content="@Mixed_Pixels">






  <meta property="og:image" content="//res.cloudinary.com/dj9pbb7v1/image/upload/ar_1:1,b_rgb:ffffff,bo_3px_solid_rgb:000000,c_fill,g_auto,r_max,w_280/v1498923272/Blog002_germany_lpjlp9.jpg">
  <meta property="twitter:image" content="//res.cloudinary.com/dj9pbb7v1/image/upload/ar_1:1,b_rgb:ffffff,bo_3px_solid_rgb:000000,c_fill,g_auto,r_max,w_280/v1498923272/Blog002_germany_lpjlp9.jpg">


  <meta property="og:image" content="//res.cloudinary.com/dj9pbb7v1/image/upload/v1498923272/Blog002_germany_lpjlp9.jpg">
  <meta property="twitter:image" content="//res.cloudinary.com/dj9pbb7v1/image/upload/v1498923272/Blog002_germany_lpjlp9.jpg">




  <meta property="og:image" content="https://res.cloudinary.com/dj9pbb7v1/image/upload/v1496825790/qQv2L8sO_o2jbiq.jpg">
  <meta property="twitter:image" content="https://res.cloudinary.com/dj9pbb7v1/image/upload/v1496825790/qQv2L8sO_o2jbiq.jpg">


    <title>Landsat image inventory in Google Earth Engine</title>

    <link rel="icon" href="https://res.cloudinary.com/dj9pbb7v1/image/upload/v1496825790/qQv2L8sO_o2jbiq.jpg">
    

    

    <link rel="canonical" href="https://philippgaertner.github.io/2017/08/landsat-image-inventory-in-google-earth-engine/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://philippgaertner.github.io/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    
      
        <link rel="stylesheet"  href="https://philippgaertner.github.io/css/stackoverflow-dark.css">
      
    
      
        <link rel="stylesheet"  href="https://philippgaertner.github.io/css/academicons-1.8.6/css/academicons.css">
      
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-64337138-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="5">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://philippgaertner.github.io/">Philipp G채rtner Blog</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://philippgaertner.github.io/#about">
    
    
    
      
        <img class="header-picture" src="https://res.cloudinary.com/dj9pbb7v1/image/upload/v1496825790/qQv2L8sO_o2jbiq.jpg" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="5">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://philippgaertner.github.io/#about">
          <img class="sidebar-profile-picture" src="https://res.cloudinary.com/dj9pbb7v1/image/upload/v1496825790/qQv2L8sO_o2jbiq.jpg" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Philipp G채rtner</h4>
        
          <h5 class="sidebar-profile-bio">Jack of all trades, master of some.</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://philippgaertner.github.io/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home" title='Home'></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://philippgaertner.github.io/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://philippgaertner.github.io/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://philippgaertner.github.io/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://philippgaertner.github.io/#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://scholar.google.de/citations?user=6vAmtJUAAAAJ&amp;hl=en" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon ai ai-google-scholar"></i>
      
      <span class="sidebar-button-desc">Google Scholar</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/philippgaertner" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://stackoverflow.com/users/1765076/philipp-g%c3%a4rtner" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-stack-overflow"></i>
      
      <span class="sidebar-button-desc">Stack Overflow</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/Mixed_Pixels" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://philippgaertner.github.io/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      
  <div class="post-header-cover
              text-left
              post-header-cover--partial"
       style="background-image:url('//res.cloudinary.com/dj9pbb7v1/image/upload/v1498923272/Blog002_germany_lpjlp9.jpg')"
       data-behavior="5">
    
      <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      Landsat image inventory in Google Earth Engine
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2017-08-08T00:00:00Z">
        
  August 8, 2017

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="https://philippgaertner.github.io/categories/landsat">Landsat</a>, 
    
      <a class="category-link" href="https://philippgaertner.github.io/categories/tutorial">Tutorial</a>, 
    
      <a class="category-link" href="https://philippgaertner.github.io/categories/github-code">GitHub Code</a>
    
  

  </div>

</div>
    
  </div>


      <div id="main" data-behavior="5"
        class="hasCover
               hasCoverMetaIn
               hasCoverCaption">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
            <span class="post-header-cover-caption caption">A Sentinel-2 false color image trajectory of central Europe, acquired 27th of May 2017. Credit: European Union, contains modified Copernicus Sentinel data 2017, processed with Google Earth Engine.</span>
          
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              

<p>In this tutorial I focus on the availability of Landsat Level-1 data products (calibrated top-of-atmosphere reflectance, orthorectified scenes only) recorded by<br />
<br></p>

<ul>
<li>the Thematic Mapper &trade; sensor onboard Landsat 4 and 5,</li>
<li>the Enhanced Thematic Mapper Plus (ETM+) sensor onboard the Landsat 7 satellite,</li>
<li>the Operational Land Imager (OLI) sensor onboard the Landsat 8 satellite.</li>
</ul>

<p>In order to use the tutorial code you would need to sign up to get access to Google&rsquo;s <a href="https://signup.earthengine.google.com/#!/" target="_blank">Earth Engine</a>. Once this is done, you will see that the tutorial is divided into sections. Each section provides Javascript code which builds up gradually to the final product.</p>

<h1 id="table-of-contents">Table of Contents</h1><nav id="TableOfContents">
<ul>
<li><a href="#application-initiation">Application Initiation</a>
<ul>
<li><a href="#1-drop-down-country-selection">1. Drop-Down Country Selection</a></li>
<li><a href="#2-adding-selected-country-borders">2. Adding Selected Country Borders</a></li>
<li><a href="#3-load-and-filter-landsat-imagecollections">3. Load and Filter Landsat ImageCollections</a></li>
<li><a href="#4-draw-histograms">4. Draw Histograms</a>
<ul>
<li><a href="#chart-landsat-mission-4-8-gee-image-availability">Chart: Landsat Mission 4-8 - GEE image availability</a></li>
</ul></li>
<li><a href="#chart-landsat-cloud-cover">Chart: Landsat cloud cover</a></li>
</ul></li>
<li><a href="#add-info-text">Add Info Text</a></li>
<li><a href="#add-for-each-wrs-2-grid-individually-sized-centroid-points">Add for each WRS-2 grid individually sized centroid points</a>
<ul>
<li><a href="#get-the-centroid">Get the Centroid</a></li>
<li><a href="#match-image-availibility-and-cloud-cover-with-circle-size">Match image availibility and cloud cover with circle size</a></li>
</ul></li>
<li><a href="#conclusions">Conclusions</a></li>
<li><a href="#epilogue">Epilogue</a></li>
</ul>
</nav>

<p><br>

 
  
  
  
  
    
      
    
  
    
      
    
  
    
  

 
  
  
  
  
    
  
    
      
    
  

<div class="figure center" >
  
    <a class="fancybox" href="//res.cloudinary.com/dj9pbb7v1/image/upload/v1498923272/Blog002_germany_lpjlp9.jpg" title="The End Product - A Metadata Application" data-fancybox-group="">
  
    <img class="fig-img" src="//res.cloudinary.com/dj9pbb7v1/image/upload/v1498923272/Blog002_germany_lpjlp9.jpg"  alt="The End Product - A Metadata Application">
  
    </a>
  
   
    <span class="caption">The End Product - A Metadata Application</span>
  
</div>

  <div style="clear:both;"></div>
</p>

<h1 id="application-initiation">Application Initiation</h1>

<p>In order to get the <em>Application</em> initialized, you have to open the <a href="https://code.earthengine.google.com/af4e50ad2d48dbb439f3bbfe8f2884b8">script</a> in the Code Editor and run the entire code once with <em>Run</em>. Now, the application is responding and does a couple of things in the background.</p>

<h2 id="1-drop-down-country-selection">1. Drop-Down Country Selection</h2>

<ul>
<li>load a FeatureCollection from the <em>Countries of the world</em>,</li>
<li>load a FeatureCollection from the <em>WRS-2 grids</em>,</li>
<li>get a list of <em>Country</em> names from the country boundary FeatureCollection,</li>
<li>create a drop-down menu with the list of <em>Country names</em> as selection option,</li>
<li>add the drop-down menu widget to the map</li>
</ul>

<p>For the <em>User</em> begins the <em>Metadata Application</em> actually now with the selection of a country by means of the freshly created drop-down selection menu. Let&rsquo;s assume the user selected <em>Germany</em> (it could also be any other country). The selection starts the <em>redraw function</em>, the main workhorse of the application, which does the following things:<br />
<br></p>

<ul>
<li>center the map to the geographical boundary of <em>Germany</em>,</li>
<li>add a layer (<span style="color:purple">purple colour</span>) with the outline of <em>Germany</em> to the map</li>
</ul>

<p>The script for these actions would look like this (<a href="https://code.earthengine.google.com/?scriptPath=users%2Fgaertnerp%2FBlog%3ALandsat-Inventory%2F01%20Dropdown%20Country%20Selection" target="_blank">Open in Code Editor</a>).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// Load country boundaries
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">countries</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ee</span>.<span style="color:#a6e22e">FeatureCollection</span>(<span style="color:#e6db74">&#34;USDOS/LSIB_SIMPLE/2017&#34;</span>);

<span style="color:#75715e">// Load Footprint of Landsat WRS2 
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">wrs2_descending</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ee</span>.<span style="color:#a6e22e">FeatureCollection</span>(<span style="color:#e6db74">&#34;users/gaertnerp/Blog/WRS2_descending&#34;</span>);

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">redraw</span>(<span style="color:#a6e22e">key</span>){
  
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">selectedCountry</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ee</span>.<span style="color:#a6e22e">Feature</span>(<span style="color:#a6e22e">countries</span>.<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">ee</span>.<span style="color:#a6e22e">Filter</span>.<span style="color:#a6e22e">eq</span>(<span style="color:#e6db74">&#39;country_na&#39;</span>, <span style="color:#a6e22e">key</span>)).<span style="color:#a6e22e">first</span>());
                          
  <span style="color:#a6e22e">Map</span>.<span style="color:#a6e22e">centerObject</span>(<span style="color:#a6e22e">selectedCountry</span>);
  
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">selectedCountry_Strg</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ee</span>.String(<span style="color:#a6e22e">selectedCountry</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;country_na&#39;</span>));
  
  <span style="color:#75715e">// Show country
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">layer0</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">Map</span>.<span style="color:#a6e22e">Layer</span>(<span style="color:#a6e22e">selectedCountry</span>, {<span style="color:#a6e22e">color</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#39;purple&#39;</span>}, <span style="color:#e6db74">&#39;Selected country&#39;</span>);
  <span style="color:#a6e22e">Map</span>.<span style="color:#a6e22e">layers</span>().<span style="color:#a6e22e">set</span>(<span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">layer0</span>);
}  

<span style="color:#75715e">// get sorted country names 
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">names</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">countries</span>.<span style="color:#a6e22e">aggregate_array</span>(<span style="color:#e6db74">&#39;country_na&#39;</span>).<span style="color:#a6e22e">sort</span>();

<span style="color:#75715e">// initialize combo-box and fire up the redraw function
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">select</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">Select</span>({<span style="color:#a6e22e">items</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">names</span>.<span style="color:#a6e22e">getInfo</span>(), <span style="color:#a6e22e">onChange</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">redraw</span> });

<span style="color:#a6e22e">select</span>.<span style="color:#a6e22e">setPlaceholder</span>(<span style="color:#e6db74">&#39;Choose a country ...&#39;</span>); 

<span style="color:#75715e">// Add the drop-down &#39;select&#39; widget to the map
</span><span style="color:#75715e"></span><span style="color:#a6e22e">Map</span>.<span style="color:#a6e22e">add</span>(<span style="color:#a6e22e">select</span>);
<span style="color:#a6e22e">Map</span>.<span style="color:#a6e22e">setOptions</span>(<span style="color:#e6db74">&#34;SATELLITE&#34;</span>);</code></pre></div>

 
  
  
  
  
    
      
    
  
    
  


<div class="figure center" >
  
    <img class="fig-img" src="//res.cloudinary.com/dj9pbb7v1/image/upload/v1617802229/2017-08-landsat-image-inventory/Drop-Down_Country_Selection.png"  alt="Outline of selected country - Germany">
  
   
    <span class="caption">Outline of selected country - Germany</span>
  
</div>

  <div style="clear:both;"></div>


<h2 id="2-adding-selected-country-borders">2. Adding Selected Country Borders</h2>

<p>In the next step, we add the <a href="https://www.usgs.gov/media/files/landsat-wrs-2-descending-path-row-shapefile" target="_blank">Landsat WRS 2 Descending Path Row</a> boundaries to the <em>redraw function</em> (<a href="https://code.earthengine.google.com/d1ef8dd9c5accef732e0caf0538f001d" target="_blank">Open in Code Editor</a>).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">redraw</span>(<span style="color:#a6e22e">key</span>){
  
  <span style="color:#75715e">// ... continuing the redraw function ........
</span><span style="color:#75715e"></span>  
  <span style="color:#75715e">// show WRS2 footprint
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">wrs2_filtered</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">wrs2_descending</span>.<span style="color:#a6e22e">filterBounds</span>(<span style="color:#a6e22e">selectedCountry</span>.<span style="color:#a6e22e">geometry</span>());
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">layer1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">Map</span>.<span style="color:#a6e22e">Layer</span>(<span style="color:#a6e22e">wrs2_filtered</span>, {<span style="color:#a6e22e">color</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;grey&#39;</span>, <span style="color:#a6e22e">opacity</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0.1</span> }, <span style="color:#e6db74">&#39;WRS2 filtered&#39;</span>);
  <span style="color:#a6e22e">Map</span>.<span style="color:#a6e22e">layers</span>().<span style="color:#a6e22e">set</span>(<span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">layer1</span>);
  <span style="color:#a6e22e">Map</span>.<span style="color:#a6e22e">setZoom</span>(<span style="color:#ae81ff">6</span>);
  
  <span style="color:#75715e">// ...........
</span><span style="color:#75715e"></span>
}</code></pre></div>

 
  
  
  
  
    
      
    
  
    
  


<div class="figure center" >
  
    <img class="fig-img" src="//res.cloudinary.com/dj9pbb7v1/image/upload/v1617802634/2017-08-landsat-image-inventory/Adding_Selected_Country_Borders.png"  alt="Filtered Landsat WRS 2 descending path row boundaries for Germany">
  
   
    <span class="caption">Filtered Landsat WRS 2 descending path row boundaries for Germany</span>
  
</div>

  <div style="clear:both;"></div>


<h2 id="3-load-and-filter-landsat-imagecollections">3. Load and Filter Landsat ImageCollections</h2>

<p>In order to get information about Landsat 4, 5, 7 and 8 Landsat Level-1 data, we load these as individual ImageCollections and merge them together to a giant dataset.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">l4_coll</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ee</span>.<span style="color:#a6e22e">ImageCollection</span>(<span style="color:#e6db74">&#34;LANDSAT/LT4_L1T_TOA&#34;</span>);  <span style="color:#75715e">//Aug 22, 1982 - Dec 14, 1993
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">l5_coll</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ee</span>.<span style="color:#a6e22e">ImageCollection</span>(<span style="color:#e6db74">&#39;LANDSAT/LT5_L1T_TOA&#39;</span>);  <span style="color:#75715e">//Jan 1, 1984 - May 5, 2012
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">l7_coll</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ee</span>.<span style="color:#a6e22e">ImageCollection</span>(<span style="color:#e6db74">&#39;LANDSAT/LE7_L1T_TOA&#39;</span>);  <span style="color:#75715e">//Jan 1, 1999 - ongoing
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">l8_coll</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ee</span>.<span style="color:#a6e22e">ImageCollection</span>(<span style="color:#e6db74">&#39;LANDSAT/LC8_L1T_TOA&#39;</span>);  <span style="color:#75715e">//Apr 11, 2013 - ongoing
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">merged_collection</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ee</span>.<span style="color:#a6e22e">ImageCollection</span>(<span style="color:#a6e22e">l4_coll</span>.<span style="color:#a6e22e">merge</span>(<span style="color:#a6e22e">l5_coll</span>).<span style="color:#a6e22e">merge</span>(<span style="color:#a6e22e">l7_coll</span>).<span style="color:#a6e22e">merge</span>(<span style="color:#a6e22e">l8_coll</span>));</code></pre></div>
<p>Now, we continue with the <em>redraw function</em> by<br />
<br></p>

<ul>
<li>filtering the Landsat ImageCollection with the selected country polygon,</li>
<li>get for each image the year of the acquisition,</li>
<li>get the <em>&lsquo;CLOUD_COVER&rsquo;</em> metadata property for each image,</li>
<li>add these metadata properties to the ImageCollection and</li>
<li>count the number of images within the ImageCollection.</li>
</ul>

<p><br></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">  <span style="color:#75715e">// ... continue the redraw function ........
</span><span style="color:#75715e"></span>
  <span style="color:#75715e">// filter the ImageCollection with the boundary of the selected country
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">iC</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">merged_collection</span>.<span style="color:#a6e22e">filterBounds</span>(<span style="color:#a6e22e">selectedCountry</span>.<span style="color:#a6e22e">geometry</span>())
                            .<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">ee</span>.<span style="color:#a6e22e">Filter</span>.<span style="color:#a6e22e">notNull</span>(<span style="color:#a6e22e">ee</span>.<span style="color:#a6e22e">List</span>([<span style="color:#e6db74">&#39;CLOUD_COVER&#39;</span>])));
  
  <span style="color:#a6e22e">iC</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">iC</span>.<span style="color:#a6e22e">map</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">img</span>){
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">year</span>  <span style="color:#f92672">=</span> <span style="color:#a6e22e">img</span>.<span style="color:#a6e22e">date</span>().<span style="color:#a6e22e">format</span>(<span style="color:#e6db74">&#34;Y&#34;</span>); <span style="color:#75715e">// get the acquisition year
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">CC</span>    <span style="color:#f92672">=</span> <span style="color:#a6e22e">img</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;CLOUD_COVER&#39;</span>);
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">img</span>.<span style="color:#a6e22e">set</span>(<span style="color:#e6db74">&#39;year&#39;</span>, <span style="color:#a6e22e">ee</span>.Number.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">year</span>)).<span style="color:#a6e22e">set</span>(<span style="color:#e6db74">&#39;clouds&#39;</span>, <span style="color:#a6e22e">ee</span>.Number.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">CC</span>)); <span style="color:#75715e">// 
</span><span style="color:#75715e"></span>  });
    
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">iC_FC</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ee</span>.<span style="color:#a6e22e">FeatureCollection</span>(<span style="color:#a6e22e">iC</span>);            
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">iC_FC_size</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">iC_FC</span>.<span style="color:#a6e22e">size</span>();
  
  <span style="color:#75715e">// ...........
</span></code></pre></div>
<h2 id="4-draw-histograms">4. Draw Histograms</h2>

<h3 id="chart-landsat-mission-4-8-gee-image-availability">Chart: Landsat Mission 4-8 - GEE image availability</h3>

<p>Now, we can draw two histogram charts which will be plotted in the lower right corner <em>Panel</em> area. The first chart shows the image availability, with time on the x-axis and <em>Image count</em> on the y-axis.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// ... continue the redraw function ........
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">options1</span> <span style="color:#f92672">=</span> {
    <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Landsat Mission 4-8 - GEE image availability&#39;</span>,
    <span style="color:#a6e22e">hAxis</span><span style="color:#f92672">:</span> {<span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Year&#39;</span>},
    <span style="color:#a6e22e">vAxis</span><span style="color:#f92672">:</span> {<span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Image count&#39;</span>},
    <span style="color:#a6e22e">colors</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#39;red&#39;</span>]
};

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">histogram</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">Chart</span>.<span style="color:#a6e22e">feature</span>.<span style="color:#a6e22e">histogram</span>({
    <span style="color:#a6e22e">features</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">iC_FC</span>,
    <span style="color:#a6e22e">property</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;year&#39;</span>,
    <span style="color:#a6e22e">minBucketWidth</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
}).<span style="color:#a6e22e">setOptions</span>(<span style="color:#a6e22e">options1</span>);

<span style="color:#a6e22e">panel</span>.<span style="color:#a6e22e">widgets</span>().<span style="color:#a6e22e">set</span>(<span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">histogram</span>);

<span style="color:#75715e">// ...........
</span></code></pre></div>
<p><img src="//res.cloudinary.com/dj9pbb7v1/image/upload/v1499023180/ee-chart_ajwy9x.png" alt="Histogram chart - Image availability per year" /></p>

<h2 id="chart-landsat-cloud-cover">Chart: Landsat cloud cover</h2>

<p>The second chart shows the <em>Cloud cover %</em> for all images recorded over <em>Germany</em>. The chart has a 5% <em>Cloud cover</em> bin width on the x-axis and shows again the <em>Image count</em> on the y-axis.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// ... continue the redraw function ........
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">options2</span> <span style="color:#f92672">=</span> {
    <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Landsat cloud cover&#39;</span>,
    <span style="color:#a6e22e">hAxis</span><span style="color:#f92672">:</span> {<span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;% Cloud Cover&#39;</span>},
    <span style="color:#a6e22e">vAxis</span><span style="color:#f92672">:</span> {<span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Image count&#39;</span>},
    <span style="color:#a6e22e">colors</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#39;orange&#39;</span>]
};

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">histogram_CC</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">Chart</span>.<span style="color:#a6e22e">feature</span>.<span style="color:#a6e22e">histogram</span>({
    <span style="color:#a6e22e">features</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">iC_FC</span>,
    <span style="color:#a6e22e">property</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;clouds&#39;</span>,
    <span style="color:#a6e22e">minBucketWidth</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">5</span>
}).<span style="color:#a6e22e">setOptions</span>(<span style="color:#a6e22e">options2</span>);

<span style="color:#a6e22e">panel</span>.<span style="color:#a6e22e">widgets</span>().<span style="color:#a6e22e">set</span>(<span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">histogram_CC</span>);

<span style="color:#75715e">// ...........
</span></code></pre></div>
<p><img src="//res.cloudinary.com/dj9pbb7v1/image/upload/v1499023180/ee-chart_1_swywbd.png" alt="Histogram chart - Image cloud cover (%)" /></p>

<h1 id="add-info-text">Add Info Text</h1>

<p>With the information on the <em>Country</em> name (<em>Germany</em>) the amount of WRS-2 grids (<em>43</em>) as well as the total number of recorded Landsat imagery (<em>16003</em>), I added a small informative info-text to the <em>Panel</em>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// ... continue the redraw function ........
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">iscoveredby</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; is covered by &#34;</span>;
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">wrs2_filtered_size</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">wrs2_filtered</span>.<span style="color:#a6e22e">size</span>();
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">LandsatWRSgridsIntotalwere</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; Landsat WRS-2 grids. During the lifetime of Landsat Mission 4-8 were &#34;</span>;
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">text</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; images collected. Their spatial distribution is shown in the map (red circles), the temporal distribution is shown in the first chart.&#34;</span>;
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">text2</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; The relative average cloud cover for each WRS-2 is shown in the map (orange circles), while the 2nd chart shows a histogram of the overall percentage cloud cover.&#34;</span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">info_text</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ee</span>.String(<span style="color:#a6e22e">selectedCountry_Strg</span>).<span style="color:#a6e22e">cat</span>(<span style="color:#a6e22e">iscoveredby</span>).<span style="color:#a6e22e">cat</span>(<span style="color:#a6e22e">wrs2_filtered_size</span>)
.<span style="color:#a6e22e">cat</span>(<span style="color:#a6e22e">LandsatWRSgridsIntotalwere</span>).<span style="color:#a6e22e">cat</span>(<span style="color:#a6e22e">iC_FC_size</span>).<span style="color:#a6e22e">cat</span>(<span style="color:#a6e22e">text</span>).<span style="color:#a6e22e">cat</span>(<span style="color:#a6e22e">text2</span>);
    
<span style="color:#a6e22e">info_text</span>.<span style="color:#a6e22e">evaluate</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">result</span>) { 
    <span style="color:#a6e22e">panel</span>.<span style="color:#a6e22e">widgets</span>().<span style="color:#a6e22e">set</span>(<span style="color:#ae81ff">2</span>, <span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">Label</span>(<span style="color:#a6e22e">result</span>));
});

<span style="color:#75715e">// ...........
</span></code></pre></div>
<blockquote>
<p>Germany is covered by 43 Landsat WRS-2 grids. During the lifetime of Landsat Mission 4-8 were 16003 images collected. Their spatial distribution is shown in the map (red circles), the temporal distribution is shown in the first chart. The relative average cloud cover for each WRS-2 is shown in the map (orange circles), while the 2nd chart shows a histogram of the overall percentage cloud cover.</p>
</blockquote>

<!-- more -->

<h1 id="add-for-each-wrs-2-grid-individually-sized-centroid-points">Add for each WRS-2 grid individually sized centroid points</h1>

<p>Here comes the most interesting part of the tutorial. The idea is, to show in the centre of each WRS-2 grid a circle, which size is dependent on the amount of the recorded images.</p>

<ul>
<li>a small circle would mean, <em>just a few images were recorded</em>, while</li>
<li>a bigger circle means, <em>here are more images available</em>.</li>
</ul>

<h2 id="get-the-centroid">Get the Centroid</h2>

<p>The <em>getCentroid</em> function is used to</p>

<ul>
<li>get the centre point (<em>centroid</em>) of each WRS-2 grid geometry and</li>

<li><p>keep the <em>Row</em> and <em>Path</em> properties</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// ... continue the redraw function ........
</span><span style="color:#75715e"></span>
<span style="color:#75715e">// create centroids
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">centroids</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">wrs2_filtered</span>.<span style="color:#a6e22e">map</span>(<span style="color:#a6e22e">getCentroid</span>);
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">fC</span>        <span style="color:#f92672">=</span> <span style="color:#a6e22e">centroids</span>.<span style="color:#a6e22e">map</span>(<span style="color:#a6e22e">addField</span>);

<span style="color:#75715e">// ...........
</span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// begin - getCentroid
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">getCentroid</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">feature</span>) {
  
<span style="color:#75715e">// Keep this list of properties.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">keepProperties</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;PATH&#39;</span>, <span style="color:#e6db74">&#39;ROW&#39;</span>];
  
<span style="color:#75715e">// Get the centroid of the feature&#39;s geometry.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">centroid</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">feature</span>.<span style="color:#a6e22e">geometry</span>().<span style="color:#a6e22e">centroid</span>();
  
<span style="color:#75715e">// Return a new Feature, copying properties from the old Feature.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ee</span>.<span style="color:#a6e22e">Feature</span>(<span style="color:#a6e22e">centroid</span>).<span style="color:#a6e22e">copyProperties</span>(<span style="color:#a6e22e">feature</span>, <span style="color:#a6e22e">keepProperties</span>);
  
}; 

<span style="color:#75715e">// end - getCentroid
</span></code></pre></div></li>
</ul>

<h2 id="match-image-availibility-and-cloud-cover-with-circle-size">Match image availibility and cloud cover with circle size</h2>

<p><img src="//res.cloudinary.com/dj9pbb7v1/image/upload/v1502455922/GEE_red_orange_centroid_dots_dy6f9l.png" alt="Image availability and cloud cover represented by circle size" /></p>

<p>Finally, the <em>addField</em> function is used to</p>

<ul>
<li>iterate over the merged <em>ImageCollection</em></li>
<li>filter each <em>Path/Row</em> pair,</li>
<li>calculate the average <em>Cloud_Cover</em> (lets assume 50%)</li>
<li>count the images (lets assume n = 400 images),</li>
<li>now I create a <span style="color:red">red circle</span> with 40km radius (n * factor 100 = 40.000 m)</li>
<li>additionally I create a <span style="color:orange">orange circle</span> with <em>Cloud_Cover</em> information.</li>

<li><p>because the <em>Cloud_Cover</em> is in my example 50 %, I reduce the circle radius from 40.000 to 20.000 m.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// beginn - addField 
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">addField</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">feature</span>) {

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">path</span>       <span style="color:#f92672">=</span> <span style="color:#a6e22e">feature</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;PATH&#39;</span>);
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">row</span>        <span style="color:#f92672">=</span> <span style="color:#a6e22e">feature</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;ROW&#39;</span>);
  
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">collection</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">merged_collection</span>.<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">ee</span>.<span style="color:#a6e22e">Filter</span>.<span style="color:#a6e22e">eq</span>(<span style="color:#e6db74">&#39;WRS_PATH&#39;</span>, <span style="color:#a6e22e">path</span>)).<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">ee</span>.<span style="color:#a6e22e">Filter</span>.<span style="color:#a6e22e">eq</span>(<span style="color:#e6db74">&#39;WRS_ROW&#39;</span>, <span style="color:#a6e22e">row</span>));
  
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">cloud_mean</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">collection</span>.<span style="color:#a6e22e">aggregate_mean</span>(<span style="color:#e6db74">&#39;CLOUD_COVER&#39;</span>);
<span style="color:#a6e22e">cloud_mean</span>     <span style="color:#f92672">=</span> <span style="color:#a6e22e">ee</span>.Number(<span style="color:#a6e22e">cloud_mean</span>);
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">count</span>      <span style="color:#f92672">=</span> <span style="color:#a6e22e">collection</span>.<span style="color:#a6e22e">size</span>();
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">f</span>          <span style="color:#f92672">=</span> <span style="color:#a6e22e">count</span>.<span style="color:#a6e22e">multiply</span>(<span style="color:#ae81ff">100</span>).<span style="color:#a6e22e">round</span>();
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">cloud_pct</span>  <span style="color:#f92672">=</span> <span style="color:#a6e22e">cloud_mean</span>.<span style="color:#a6e22e">multiply</span>(<span style="color:#a6e22e">f</span>).<span style="color:#a6e22e">divide</span>(<span style="color:#ae81ff">100</span>).<span style="color:#a6e22e">round</span>();
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">keepProperties</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;PATH&#39;</span>, <span style="color:#e6db74">&#39;ROW&#39;</span>, <span style="color:#e6db74">&#39;CLOUD_COVER&#39;</span>];
  
<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">feature</span>.<span style="color:#a6e22e">set</span>({<span style="color:#e6db74">&#39;count&#39;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">f</span>}).<span style="color:#a6e22e">set</span>({<span style="color:#e6db74">&#39;cloud_mean&#39;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cloud_mean</span>}).<span style="color:#a6e22e">set</span>({<span style="color:#e6db74">&#39;cloud_pct&#39;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cloud_pct</span>})
.<span style="color:#a6e22e">copyProperties</span>(<span style="color:#a6e22e">feature</span>, <span style="color:#a6e22e">keepProperties</span>);

}; 

<span style="color:#75715e">// end - addField
</span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// ... continue the redraw function ........
</span><span style="color:#75715e"></span>
<span style="color:#75715e">// buffer centroid according to image counts
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">buffered_points</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">fC</span>.<span style="color:#a6e22e">map</span>(<span style="color:#a6e22e">buffer_count</span>).<span style="color:#a6e22e">flatten</span>();
  
<span style="color:#75715e">// buffer centroid according to cloud percentage
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">buffered_points_cloud</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">fC</span>.<span style="color:#a6e22e">map</span>(<span style="color:#a6e22e">buffer_cloud</span>).<span style="color:#a6e22e">flatten</span>();
  
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">outlines</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">empty</span>.<span style="color:#a6e22e">paint</span>({<span style="color:#a6e22e">featureCollection</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">buffered_points</span>, <span style="color:#a6e22e">color</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">width</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2</span>});

<span style="color:#75715e">// show image count circles
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">filledOutlines</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">empty</span>.<span style="color:#a6e22e">paint</span>(<span style="color:#a6e22e">buffered_points</span>).<span style="color:#a6e22e">paint</span>(<span style="color:#a6e22e">buffered_points</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>).<span style="color:#a6e22e">clip</span>(<span style="color:#a6e22e">wrs2_filtered</span>);
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">layer2</span>         <span style="color:#f92672">=</span> <span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">Map</span>.<span style="color:#a6e22e">Layer</span>(<span style="color:#a6e22e">filledOutlines</span>, {<span style="color:#a6e22e">palette</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#39;red&#39;</span>].<span style="color:#a6e22e">concat</span>(<span style="color:#a6e22e">palette</span>)}, <span style="color:#e6db74">&#39;Landsat image count&#39;</span>);
<span style="color:#a6e22e">Map</span>.<span style="color:#a6e22e">layers</span>().<span style="color:#a6e22e">set</span>(<span style="color:#ae81ff">2</span>, <span style="color:#a6e22e">layer2</span>);

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">innerCircles</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">empty</span>.<span style="color:#a6e22e">paint</span>(<span style="color:#a6e22e">buffered_points_cloud</span>).<span style="color:#a6e22e">paint</span>(<span style="color:#a6e22e">buffered_points_cloud</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>).<span style="color:#a6e22e">clip</span>(<span style="color:#a6e22e">wrs2_filtered</span>);
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">layer3</span>       <span style="color:#f92672">=</span> <span style="color:#a6e22e">ui</span>.<span style="color:#a6e22e">Map</span>.<span style="color:#a6e22e">Layer</span>(<span style="color:#a6e22e">innerCircles</span>, {<span style="color:#a6e22e">palette</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#39;orange&#39;</span>].<span style="color:#a6e22e">concat</span>(<span style="color:#a6e22e">palette</span>)}, <span style="color:#e6db74">&#39;Cloud percentage (avg.)&#39;</span>);
<span style="color:#a6e22e">Map</span>.<span style="color:#a6e22e">layers</span>().<span style="color:#a6e22e">set</span>(<span style="color:#ae81ff">3</span>, <span style="color:#a6e22e">layer3</span>);
  
<span style="color:#75715e">// end of redraw function
</span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">buffer_count</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">feature</span>) {

<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ee</span>.<span style="color:#a6e22e">FeatureCollection</span>(<span style="color:#a6e22e">feature</span>.<span style="color:#a6e22e">buffer</span>(<span style="color:#a6e22e">feature</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;count&#39;</span>)));

}; <span style="color:#75715e">// end - buffer_count
</span><span style="color:#75715e"></span>
<span style="color:#75715e">// ##################################################  
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">buffer_cloud</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">feature</span>) {
  
<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ee</span>.<span style="color:#a6e22e">FeatureCollection</span>(<span style="color:#a6e22e">feature</span>.<span style="color:#a6e22e">buffer</span>(<span style="color:#a6e22e">feature</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;cloud_pct&#39;</span>)));
  
}; <span style="color:#75715e">// end - buffer_cloud
</span></code></pre></div></li>
</ul>

<h1 id="conclusions">Conclusions</h1>

<p>It is straight forward to count Landsat images from the available <strong>ImageCollections</strong> and read the overall cloudiness from each image metadata. However, what we see are not all recorded images which are out there, these are &ldquo;just&rdquo; all images the USGS is holding. Still missing are the data stored in the ESA archive.</p>

<h1 id="epilogue">Epilogue</h1>

<p>Well, that&rsquo;s it, go ahead and have a look at the provided <a href="https://code.earthengine.google.com/af4e50ad2d48dbb439f3bbfe8f2884b8">github script</a> and thanks for reading. Feel free to ask questions or have some comments for improvements here on this blog or on <a href="https://twitter.com/gartn001">twitter</a>, I am always keen to learn new techniques regarding information retrieval and data visualization.
<img src="https://vg05.met.vgwort.de/na/f02f0f31545c41f68a844208e60d162b" width="1" height="1" alt=""></p>

              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://philippgaertner.github.io/tags/featurecollection/">FeatureCollection</a>

  <a class="tag tag--primary tag--small" href="https://philippgaertner.github.io/tags/imagecollection/">ImageCollection</a>

  <a class="tag tag--primary tag--small" href="https://philippgaertner.github.io/tags/google-earth-engine/">Google-Earth-Engine</a>

  <a class="tag tag--primary tag--small" href="https://philippgaertner.github.io/tags/metadata/">Metadata</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://philippgaertner.github.io/2017/10/european-capital-greenness-evaluation/" data-tooltip="European capital greenness evaluation">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://philippgaertner.github.io/2017/06/welcome-to-my-new-blog/" data-tooltip="Welcome to my new Blog">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#table-of-contents">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    <script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="0l94rzR" data-color="#ffffff" data-emoji=""  data-font="Cookie" data-text="Coffee for Philipp" data-outline-color="#000000" data-font-color="#000000" data-coffee-color="#000000" ></script>&copy; 2017 - 2022 Philipp G채rtner &VerticalSeparator; Some Rights Reserved<br>Content on this site is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</a>.
  </span>
</footer> 
      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://philippgaertner.github.io/2017/10/european-capital-greenness-evaluation/" data-tooltip="European capital greenness evaluation">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://philippgaertner.github.io/2017/06/welcome-to-my-new-blog/" data-tooltip="Welcome to my new Blog">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#table-of-contents">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="5">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://res.cloudinary.com/dj9pbb7v1/image/upload/v1496825790/qQv2L8sO_o2jbiq.jpg" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Philipp G채rtner</h4>
    
      <div id="about-card-bio">Jack of all trades, master of some.</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Staff at the Federal Environment Agency
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Berlin, Germany
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://philippgaertner.github.io/images/blur.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://philippgaertner.github.io/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
      <script>
        var disqus_config = function () {
          this.page.url = 'https:\/\/philippgaertner.github.io\/2017\/08\/landsat-image-inventory-in-google-earth-engine\/';
          
            this.page.identifier = '\/2017\/08\/landsat-image-inventory-in-google-earth-engine\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'gartn001';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  




    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css" />
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script>
<script>
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#2D2D39"
    },
    "button": {
      "background": "#14a7d0"
    }
  },
  "theme": "edgeless",
  "position": "bottom-right",
  "content": {
      "message": "This website uses cookies for Google Analytics so that I know how many people are reading the blog and which blogposts are the most popular. The website does not collect any personal data.",
  "href": "https://www.cookiesandyou.com/"
  }
});
</script>
  </body>
</html>

